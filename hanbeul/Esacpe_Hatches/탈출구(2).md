# 5ì£¼ì°¨. íƒˆì¶œêµ¬(2)

## Effectë¡œ ë™ê¸°í™”í•˜ê¸°

### Effectë€?

ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ëŠ” 2ê°€ì§€ ë¡œì§ ìœ í˜•ì´ ìˆë‹¤.

ë Œë”ë§ ì½”ë“œ ë° ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì¸ë°, ì´ ë‘ ê°€ì§€ ë¡œì§ë§Œìœ¼ë¡œ ëª¨ë“  ë¡œì§ì„ ë‹¤ êµ¬í˜„í•  ìˆ˜ëŠ” ì—†ë‹¤.

EffectëŠ” ë Œë”ë§ ìì²´ì— ì˜í•´ ë°œìƒí•˜ëŠ” ë¶€ìˆ˜ íš¨ê³¼ë¥¼ íŠ¹ì •í•˜ëŠ” ê²ƒìœ¼ë¡œ, íŠ¹ì • ì´ë²¤íŠ¸ê°€ ì•„ë‹Œ ë Œë”ë§ì— ì˜í•´ ì§ì ‘ ë°œìƒí•œë‹¤.

---

### Effectë¥¼ ì‘ì„±í•˜ëŠ” ë²•

> 1. Effect ì„ ì–¸í•˜ê¸°

ëª¨ë‘ì—ê²Œ ë„ˆë¬´ë„ ì¹œìˆ™í•œ `useEffect`ë¥¼ ì„ ì–¸í•´ë³´ì.

```js
import { useEffect } from "react";

function MyComponent() {
  useEffect(() => {
    // ì´ê³³ì˜ ì½”ë“œëŠ” *ëª¨ë“ * ë Œë”ë§ í›„ì— ì‹¤í–‰ë©ë‹ˆë‹¤
  });
  return <div />;
}
```

ê³µì‹ ë¬¸ì„œì— ì í˜€ìˆëŠ” ëŒ€ë¡œ, useEffect ë‚´ë¶€ì˜ ë¡œì§ì€ 'ëª¨ë“ ' ë Œë”ë§ ì´í›„ì— ì‹¤í–‰ëœë‹¤.

ë”°ë¼ì„œ ë Œë”ë§ ìš”ì†Œì— ì§ì ‘ ì ‘ê·¼í•˜ëŠ” ë“±ì˜ í–‰ìœ„ëŠ” effect ì•ˆì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

> 2. Effectì˜ ì˜ì¡´ì„± ì§€ì •í•˜ê¸°

Effectë¥¼ ë¶ˆí•„ìš”í•˜ê²Œ ë‹¤ì‹œ ì‹¤í–‰í•˜ì§€ ì•Šê¸° ìœ„í•´ `ì˜ì¡´ì„± ë°°ì—´`ì„ ì§€ì •í•œë‹¤.

useEffect í˜¸ì¶œì˜ ë‘ë²ˆì§¸ ì¸ìì— ì¶”ê°€í•´ì£¼ë©´ ëœë‹¤.

```js
useEffect(() => {
  // ...
}, []);
```

ì˜ì¡´ì„± ë°°ì—´ì´ ë¹ˆ ë°°ì—´ì¼ ê²½ìš°ì—ëŠ” 'ìµœì´ˆ ë Œë”ë§ ì‹œ'ì—ë§Œ ë™ì‘í•œë‹¤.

ì´ì™¸ì— ì˜ì¡´ì„± ë°°ì—´ì— ë‹¤ë¥¸ ê°’ì´ ë“¤ì–´ê°ˆ ê²½ìš°, ë Œë”ë§ ì´í›„ì— í•´ë‹¹ ê°’ì´ ë³€ê²½ëœ ê²½ìš°ì— ì‹¤í–‰ëœë‹¤.

ë‹¤ìŒì€ ì•ì„œ ë§í•œ ì„¸ ê°€ì§€ ê²½ìš°ì˜ effect ì˜ˆì‹œì´ë‹¤.

```js
useEffect(() => {
  // ëª¨ë“  ë Œë”ë§ í›„ì— ì‹¤í–‰ë©ë‹ˆë‹¤
});

useEffect(() => {
  // ë§ˆìš´íŠ¸ë  ë•Œë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤ (ì»´í¬ë„ŒíŠ¸ê°€ ë‚˜íƒ€ë‚  ë•Œ)
}, []);

useEffect(() => {
  // ë§ˆìš´íŠ¸ë  ë•Œ ì‹¤í–‰ë˜ë©°, *ë˜í•œ* ë Œë”ë§ ì´í›„ì— a ë˜ëŠ” b ì¤‘ í•˜ë‚˜ë¼ë„ ë³€ê²½ëœ ê²½ìš°ì—ë„ ì‹¤í–‰ë©ë‹ˆë‹¤
}, [a, b]);
```

> 3. (í•„ìš”í•  ê²½ìš°) í´ë¦°ì—… ì¶”ê°€

í´ë¦°ì—… í•¨ìˆ˜ëŠ” `useEffect` ë¬¸ ì•ˆì— `return` ë¬¸ìœ¼ë¡œ ì¶”ê°€í•´ì¤„ ìˆ˜ ìˆë‹¤.

EffectëŠ” íƒˆì¶œêµ¬ë¡œì¨ ë¦¬ì•¡íŠ¸ ì™¸ë¶€ì˜ ìƒíƒœë¥¼ ì°¸ì¡°í•˜ê±°ë‚˜ API ë“±ê³¼ì˜ ì—°ë™ì„ ìœ„í•´ ë¹ˆë²ˆíˆ ì‚¬ìš©ëœë‹¤.

ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ ë˜ì—ˆì„ ë•Œë„ í•´ë‹¹ ì™¸ë¶€ì˜ ìƒíƒœë¥¼ ì°¸ì¡°í•˜ê³  ìˆê±°ë‚˜, APIì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í´ë¦°ì—…ì´ í•„ìš”í•  ìˆ˜ ìˆë‹¤.

```js
useEffect(() => {
  const connection = createConnection();
  connection.connect();
  return () => {
    connection.disconnect();
  };
}, []);
```

ë§Œì•½ í•´ë‹¹ ì½”ë“œì— í´ë¦°ì—… í•¨ìˆ˜(`connection.disconnect()`)ê°€ ì—†ë‹¤ë©´, í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ê°€ í˜¸ì¶œë  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ì»¤ë„¥ì…˜ì„ ë§ºì„ ê²ƒì´ê³  í•´ë‹¹ ì»¤ë„¥ì…˜ë“¤ì€ ì—°ê²°ëœ ì±„ë¡œ ì ì  ìŒ“ì—¬ê°ˆ ê²ƒì´ë‹¤.

---

## Effectê°€ í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš°

ê³µì‹ë¬¸ì„œëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ ì¼ë°˜ì ì¸ ê²½ìš° Effectê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤ê³  ë§í•œë‹¤.

ì²«ì§¸, ë Œë”ë§ì„ ìœ„í•´ ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ”ë° Effectê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤.

ë‘˜ì§¸, ì‚¬ìš©ì ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë° Effectê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤.

EffectëŠ” 'íƒˆì¶œêµ¬'ë¡œì¨ í•„ìˆ˜ì ì¸ ë¶€ë¶„ì—ë§Œ ì‚¬ìš©ë˜ëŠ” ê²ƒì´ ê¶Œì¥ëœë‹¤.

í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ê°œë°œ í¸ì˜ì„±ì— ì§‘ì¤‘í•˜ë‹¤ ë³´ë©´ ë¬´ë¶„ë³„í•œ Effectë¥¼ ì‚¬ìš©í•˜ê¸°ë„ í•œë‹¤.

ë‹¤ìŒ í”íˆ ë†“ì¹˜ëŠ” ì˜ˆì‹œë“¤ì„ ë³´ë©° Effectë¥¼ 'ì˜' ì¨ë³´ì.

### 1. props ë˜ëŠ” stateì— ë”°ë¼ state ì—…ë°ì´íŠ¸ í•˜ê¸°

ë‹¤ë¥¸ stateë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ stateë¥¼ ì²˜ë¦¬í•´ì£¼ê¸° ìœ„í•´ useEffectë¥¼ ì‚¬ìš©í•  ë•Œê°€ ìˆë‹¤.

ì–´ë–»ê²Œë³´ë©´ useStateë¥¼ ë„ˆë¬´ ë‚¨ë°œí•œ ê²ƒì¸ë°, ê°œì¸ì ìœ¼ë¡œëŠ” `const`ëŠ” ë³€ê²½í•  ìˆ˜ ì—†ë‹¤ëŠ” ìƒê°ì´ ë¨¼ì € ë“¤ì–´ì„œì¸ë“¯ í•˜ë‹¤.

```js
function Form() {
  const [firstName, setFirstName] = useState("Taylor");
  const [lastName, setLastName] = useState("Swift");

  // ğŸ”´ í”¼í•˜ì„¸ìš”: ì¤‘ë³µëœ state ë° ë¶ˆí•„ìš”í•œ Effect
  const [fullName, setFullName] = useState("");
  useEffect(() => {
    setFullName(firstName + " " + lastName);
  }, [firstName, lastName]);
  // ...
}
```

---

### 2. ë¹„ìš©ì´ ë§ì´ ë“œëŠ” ê³„ì‚° ìºì‹±í•˜ê¸°

`useMemo` í›…ì„ ì´ìš©í•´ ê³„ì‚°ì„ ìºì‹±(ë©”ëª¨ì´ì œì´ì…˜) ì²˜ë¦¬

```js
import { useMemo, useState } from "react";

function TodoList({ todos, filter }) {
  const [newTodo, setNewTodo] = useState("");
  // âœ… todosë‚˜ filterê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ getFilteredTodos()ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
  const visibleTodos = useMemo(
    () => getFilteredTodos(todos, filter),
    [todos, filter]
  );
  // ...
}
```

---

### 3. prop ë³€ê²½ì‹œ ëª¨ë“  state ì´ˆê¸°í™”

propsì˜ ê°’ì„ íŠ¹ì • ì»´í¬ë„ŒíŠ¸ì˜ keyë¡œ ì „ë‹¬í•´ ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§

```js
export default function ProfilePage({ userId }) {
  return <Profile userId={userId} key={userId} />;
}

function Profile({ userId }) {
  // âœ… ì´ state ë° ì•„ë˜ì˜ ë‹¤ë¥¸ stateëŠ” key ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ ì¬ì„¤ì •
  const [comment, setComment] = useState("");
  // ...
}
```

---

### 4. propì´ ë³€ê²½ë  ë•Œ ì¼ë¶€ state ì¡°ì •í•˜ê¸°

propsë¥¼ Effectì˜ ì˜ì¡´ì„± ë°°ì—´ì— ë„£ëŠ” ê²ƒì´ ì•„ë‹Œ, ë Œë”ë§ ì¤‘ ì§ì ‘ stateë¥¼ ì¡°ì •

```js
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selection, setSelection] = useState(null);

  // ë Œë”ë§ ì¤‘ì— ëª¨ë“  ê²ƒì„ ê³„ì‚°
  const selection = items.find((item) => item.id === selectedId) ?? null;
  // ...
}
```

---

### 5. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ê°„ ë¡œì§ ê³µìœ 

ë¶ˆí•„ìš”í•œ Effectë¥¼ ì œê±°í•˜ê³  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ ì´ë²¤íŠ¸ë³„ ë¡œì§ í˜¸ì¶œ

```js
function ProductPage({ product, addToCart }) {
  // ğŸ”´ Effect ë‚´ë¶€ì˜ ì´ë²¤íŠ¸ë³„ ë¡œì§
  useEffect(() => {
    if (product.isInCart) {
      showNotification(`Added ${product.name} to the shopping cart!`);
    }
  }, [product]);

  function handleBuyClick() {
    addToCart(product);
  }

  function handleCheckoutClick() {
    addToCart(product);
    navigateTo("/checkout");
  }

  // âœ… ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ ì´ë²¤íŠ¸ë³„ ë¡œì§ì´ í˜¸ì¶œë¨
  function buyProduct() {
    addToCart(product);
    showNotification(`Added ${product.name} to the shopping cart!`);
  }

  function handleBuyClick() {
    buyProduct();
  }

  function handleCheckoutClick() {
    buyProduct();
    navigateTo("/checkout");
  }
  // ...
}
```

---

### 6. POST ìš”ì²­ ë³´ë‚´ê¸°

Effectê°€ ì•„ë‹Œ í•¸ë“¤ëŸ¬ì— ë„£ì–´ POST ìš”ì²­í•˜ê¸°

```js
function Form() {
  const [firstName, setFirstName] = useState("");
  const [lastName, setLastName] = useState("");

  // âœ… ì»´í¬ë„ŒíŠ¸ê°€ í‘œì‹œ í›„ ë¡œì§ ì‹¤í–‰
  useEffect(() => {
    post("/analytics/event", { eventName: "visit_form" });
  }, []);

  // ğŸ”´ Effect ë‚´ë¶€ì˜ ì´ë²¤íŠ¸ë³„ ë¡œì§
  // const [jsonToSubmit, setJsonToSubmit] = useState(null);
  // useEffect(() => {
  //   if (jsonToSubmit !== null) {
  //     post("/api/register", jsonToSubmit);
  //   }
  // }, [jsonToSubmit]);

  function handleSubmit(e) {
    e.preventDefault();
    // setJsonToSubmit({ firstName, lastName });
    // âœ… ì´ë²¤íŠ¸ë³„ ë¡œì§ì€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ì¡´ì¬
    post("/api/register", { firstName, lastName });
  }
  // ...
}
```

---

### 7. ì—°ì‡„ ê³„ì‚°

ë Œë”ë§ ì¤‘ì— ê°€ëŠ¥í•œ ê°’ì„ ê³„ì‚°í•˜ê³ , ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ state ì¡°ì •

--

### 8. ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™”

ì•±ì´ ë¡œë“œë  ë•Œ í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ëŠ” ê²½ìš° ë³€ìˆ˜ë¥¼ ì¶”ê°€í•˜ì—¬ ì¶”ì í•˜ê±°ë‚˜ ì•± ë Œë”ë§ ì „ì— ì‹¤í–‰

```js
// ë³€ìˆ˜ ì‚¬ìš©
let didInit = false;

function App() {
  useEffect(() => {
    if (!didInit) {
      didInit = true;
      // âœ… ì•± ë¡œë“œë‹¹ í•œ ë²ˆë§Œ ì‹¤í–‰
      loadDataFromLocalStorage();
      checkAuthToken();
    }
  }, []);
  // ...
}

// ì•± ë Œë”ë§ ì „ì— ì‹¤í–‰
if (typeof window !== "undefined") {
  // ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.
  // âœ… ì•± ë¡œë“œë‹¹ í•œ ë²ˆë§Œ ì‹¤í–‰
  checkAuthToken();
  loadDataFromLocalStorage();
}

function App() {
  // ...
}
```

---

### 9. state ë³€ê²½ì„ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ê²Œ ì•Œë¦¬ê¸°

Effectë¥¼ í™œìš©í•´ propsì—ì„œ ë°›ì•„ì˜¨ functionì„ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, onChange í•¨ìˆ˜ì—ì„œ í•´ë‹¹ functionì„ í•¨ê»˜ ì‹¤í–‰

```js
function Toggle({ onChange }) {
  const [isOn, setIsOn] = useState(false);

  function updateToggle(nextIsOn) {
    // âœ… ì—…ë°ì´íŠ¸ë¥¼ ìœ ë°œí•œ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ë™ì•ˆ ëª¨ë“  ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜í–‰
    setIsOn(nextIsOn);
    onChange(nextIsOn);
  }

  function handleClick() {
    updateToggle(!isOn);
  }

  function handleDragEnd(e) {
    if (isCloserToRightEdge(e)) {
      updateToggle(true);
    } else {
      updateToggle(false);
    }
  }

  // ...
}
```

---

### 10. ë¶€ëª¨ì—ê²Œ ë°ì´í„° ì „ë‹¬í•˜ê¸°

ìì‹ê³¼ ë¶€ëª¨ê°€ ê°™ì€ ë°ì´í„°ë¥¼ í•„ìš”ë¡œ í•  ë•Œì—ëŠ” ë¶€ëª¨ì—ì„œ stateë¥¼ ì„ ì–¸í•´ì„œ ìì‹ì—ê²Œ ë‚´ë ¤ì£¼ì.

---

### 11. ì™¸ë¶€ ì €ì¥ì†Œ êµ¬ë…í•˜ê¸°

ì™¸ë¶€ ì €ì¥ì†Œ ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì»´í¬ë„ŒíŠ¸ì—ì„œ stateë¥¼ ì—…ë°ì´íŠ¸ í•´ì•¼ë˜ëŠ” ê²½ìš°, Effect ëŒ€ì‹  `useSyncExternalStore` í›…ì„ ì‚¬ìš©í•˜ì.

```js
function subscribe(callback) {
  window.addEventListener("online", callback);
  window.addEventListener("offline", callback);
  return () => {
    window.removeEventListener("online", callback);
    window.removeEventListener("offline", callback);
  };
}

function useOnlineStatus() {
  // âœ… ë‚´ì¥ Hookìœ¼ë¡œ ì™¸ë¶€ ìŠ¤í† ì–´ êµ¬ë…
  return useSyncExternalStore(
    subscribe, // ë™ì¼í•œ í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ëŠ” í•œ ReactëŠ” ë‹¤ì‹œ êµ¬ë…í•˜ì§€ ì•ŠìŒ
    () => navigator.onLine,
    () => true
  );
}

function ChatIndicator() {
  const isOnline = useOnlineStatus();
  // ...
}
```

---

### 12. ë°ì´í„° ê°€ì ¸ì˜¤ê¸°

> ê²½ìŸ ì¡°ê±´: ì„œë¡œ ë‹¤ë¥¸ ë‘ ìš”ì²­ì´ ì„œë¡œ â€œê²½ìŸâ€í•˜ì—¬ ì˜ˆìƒê³¼ ë‹¤ë¥¸ ìˆœì„œë¡œ ë„ì°©í•˜ëŠ” ê²ƒ

ê²½ìŸ ì¡°ê±´ì„ ìˆ˜ì •í•˜ê¸° ìœ„í•´ ì˜¤ë˜ëœ ì‘ë‹µì„ ë¬´ì‹œí•˜ëŠ” ì •ë¦¬ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•´ì•¼ í•¨.

```js
// Effectê°€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ë§ˆì§€ë§‰ìœ¼ë¡œ ìš”ì²­ëœ ì‘ë‹µì„ ì œì™¸í•œ ëª¨ë“  ì‘ë‹µì´ ë¬´ì‹œë¨
function SearchResults({ query }) {
  const [results, setResults] = useState([]);
  const [page, setPage] = useState(1);
  useEffect(() => {
    let ignore = false;
    fetchResults(query, page).then((json) => {
      if (!ignore) {
        setResults(json);
      }
    });
    return () => {
      ignore = true;
    };
  }, [query, page]);

  function handleNextPageClick() {
    setPage(page + 1);
  }
  // ...
}
```

---
